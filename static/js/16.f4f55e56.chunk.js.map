{"version":3,"sources":["app/components/register/login/Login.js"],"names":["Login","props","api","axios","create","baseURL","history","useHistory","loginUser","a","post","inputs","then","res","token","data","access","decoded","jwtDecode","decoded_quy","console","log","alert","role","push","window","setTimeout","location","reload","bind","localStorage","setItem","catch","err","useState","username","password","setInputs","submitted","setSubmitted","handleChange","event","target","name","value","className","id","onSubmit","preventDefault","htmlFor","onChange","type","placeholder","to"],"mappings":"gOA2GeA,UAtGf,SAAeC,GACb,IAAMC,EAAMC,IAAMC,OAAO,CACvBC,QAAQ,mEAENC,EAAUC,cACRC,EAAS,uCAAG,sBAAAC,EAAA,sEACAP,EACbQ,KAAK,IAAKC,GACVC,MAAK,SAACC,GACL,IAAMC,EAAQD,EAAIE,KAAKC,OAEnBC,EAAUC,YAAUJ,GACpBK,EAAcD,YAFP,2MAGXE,QAAQC,IAAIF,GACZG,MAAM,qBACe,UAAjBL,EAAQM,OACVjB,EAAQkB,KAAK,eACbC,OAAOC,WAAWD,OAAOE,SAASC,OAAOC,KAAKJ,OAAOE,UAAW,KAE7C,SAAjBV,EAAQM,OACVH,QAAQC,IAAIJ,GACZX,EAAQkB,KAAK,UACbC,OAAOC,WAAWD,OAAOE,SAASC,OAAOC,KAAKJ,OAAOE,UAAW,KAElEG,aAAaC,QAAQ,QAASjB,MAE/BkB,OAAM,SAACC,GACNb,QAAQC,IAAIY,MAtBA,yDAAH,qDALK,EAoCQC,mBAAS,CACnCC,SAAU,GACVC,SAAU,KAtCQ,mBAoCbzB,EApCa,KAoCL0B,EApCK,OAwCcH,oBAAS,GAxCvB,mBAwCbI,EAxCa,KAwCFC,EAxCE,KAyCZJ,EAAuBxB,EAAvBwB,SAAUC,EAAazB,EAAbyB,SAClB,SAASI,EAAaC,GAAQ,IAAD,EACHA,EAAMC,OAAtBC,EADmB,EACnBA,KAAMC,EADa,EACbA,MACdP,GAAU,SAAC1B,GAAD,mBAAC,eAAiBA,GAAlB,kBAA2BgC,EAAOC,OAY9C,OACE,sBAAKC,UAAU,YAAf,UACE,uBAAMC,GAAG,aAAaD,UAAU,OAAOE,SAZ3C,SAAsBN,GACpBA,EAAMO,iBACNT,GAAa,GACTJ,GAAYC,IACdC,EAAU1B,GACVS,QAAQC,IAAIV,GACZH,MAMA,UACE,+CACA,sBACEqC,UAAW,gBAAkBP,IAAcH,EAAW,SAAW,KADnE,UAGE,uBAAOc,QAAQ,WAAf,sBACA,uBACEN,KAAK,WACLC,MAAOT,EACPe,SAAUV,EACVW,KAAK,OACLL,GAAG,iBACHM,YAAY,mBAEd,wDAEF,sBACEP,UAAW,gBAAkBP,IAAcF,EAAW,SAAW,KADnE,UAGE,uBAAOa,QAAQ,WAAf,sBACA,uBACEN,KAAK,WACLC,MAAOR,EACPc,SAAUV,EACVW,KAAK,WACLL,GAAG,iBACHM,YAAY,mBAEd,wDAEF,wBAAQD,KAAK,SAAb,uBAEF,sBAAKN,UAAU,QAAf,UACE,cAAC,IAAD,CAAMQ,GAAG,IAAIR,UAAU,WAAvB,kBAGA,cAAC,IAAD,CAAMQ,GAAG,YAAYR,UAAU,WAA/B,8B","file":"static/js/16.f4f55e56.chunk.js","sourcesContent":["import axios from \"axios\";\r\nimport jwtDecode from \"jwt-decode\";\r\nimport React, { useState } from \"react\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport \"./../css/register.css\";\r\nfunction Login(props) {\r\n  const api = axios.create({\r\n    baseURL: `http://phucnb-django-example.herokuapp.com/api/user/auth/login`,\r\n  });\r\n  let history = useHistory();\r\n  const loginUser = async () => {\r\n    let res = await api\r\n      .post(\"/\", inputs)\r\n      .then((res) => {\r\n        const token = res.data.access;\r\n        const to = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2MTU0MjgxNTEwMTAsImlhdCI6MTYxNTM0MTc1MTAxMCwiaWQiOiI2MDM0YTg5YTZjOTRjMTVjYWNhMzU5ZDIiLCJpc3MiOiJ2YW5sZTMifQ.USxKvtOnpkg75llCodJ1hEWBSJz0FTt7qT6Uku_udyE\"\r\n        let decoded = jwtDecode(token);\r\n        let decoded_quy = jwtDecode(to);\r\n        console.log(decoded_quy);\r\n        alert(\"submit thanh cong\");\r\n        if (decoded.role === \"admin\") {\r\n          history.push(\"/admin/user\");\r\n          window.setTimeout(window.location.reload.bind(window.location), 10);\r\n        }\r\n        if (decoded.role === \"user\") {\r\n          console.log(decoded);\r\n          history.push(\"/carts\");\r\n          window.setTimeout(window.location.reload.bind(window.location), 10);\r\n        }\r\n        localStorage.setItem(\"token\", token);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  };\r\n  // Bước 1: khai báo State - gồm 2 phần tử input và setInput.\r\n  // Bước 2: khai báo inputs = {} object.\r\n  // Bước 3: function handleChange(e), nhận 2 trường name, value;\r\n  // Bước 4: onChange - khi input thay đổi thì gọi handleChange()\r\n  // Bước 5: setInputs(giá trị input => ({...inputs, [name]: value))\r\n  // Bước 6: Khi nhấn Submit =>\r\n  const [inputs, setInputs] = useState({\r\n    username: \"\",\r\n    password: \"\",\r\n  });\r\n  const [submitted, setSubmitted] = useState(false);\r\n  const { username, password } = inputs;\r\n  function handleChange(event) {\r\n    const { name, value } = event.target;\r\n    setInputs((inputs) => ({ ...inputs, [name]: value }));\r\n  }\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n    setSubmitted(true);\r\n    if (username && password) {\r\n      setInputs(inputs);\r\n      console.log(inputs);\r\n      loginUser();\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <form id=\"form-login\" className=\"form\" onSubmit={handleSubmit}>\r\n        <h2>Login With Us</h2>\r\n        <div\r\n          className={\"form-control\" + (submitted && !username ? \" error\" : \" \")}\r\n        >\r\n          <label htmlFor=\"username\">Username</label>\r\n          <input\r\n            name=\"username\"\r\n            value={username}\r\n            onChange={handleChange}\r\n            type=\"text\"\r\n            id=\"username-login\"\r\n            placeholder=\"Enter username\"\r\n          />\r\n          <small>Error username !</small>\r\n        </div>\r\n        <div\r\n          className={\"form-control\" + (submitted && !password ? \" error\" : \" \")}\r\n        >\r\n          <label htmlFor=\"password\">Password</label>\r\n          <input\r\n            name=\"password\"\r\n            value={password}\r\n            onChange={handleChange}\r\n            type=\"password\"\r\n            id=\"password-login\"\r\n            placeholder=\"Enter password\"\r\n          />\r\n          <small>Error password !</small>\r\n        </div>\r\n        <button type=\"submit\">Submit</button>\r\n      </form>\r\n      <div className=\"group\">\r\n        <Link to=\"/\" className=\"btn-link\">\r\n          Back\r\n        </Link>\r\n        <Link to=\"/register\" className=\"btn-link\">\r\n          Register\r\n        </Link>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n"],"sourceRoot":""}